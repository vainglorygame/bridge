<!doctype html>
<html>
    <head>
        <title>Vainsocial backend status</title>
    </head>
    <body>
        <form id="update-form">
            <input type="text">
            <input type="submit" value="Update">
        </form>

        <ul id="updates"></ul>
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script>
            $("#update-form").submit(function(e) {
                $.get("/api/player/" + $("input:first").val()).done(function() {
                    $("#updates").append(
                        $("<li>")
                        .text("(found)")
                        .css("color", "black")
                    );
                }).fail(function() {
                    $("#updates").append(
                        $("<li>")
                        .text("(not found)")
                        .css("color", "red")
                    );
                });
                e.preventDefault();
            });
            var socket = io();
            socket.on("job update", function(msg) {
                $("#updates").append(
                    $("<li>")
                    .text(msg)
                    .css("color", "grey")
                );
            });
            socket.on("player grab failed", function(msg) {
                $("#updates").append(
                    $("<li>")
                    .text("no new data for player " + msg.id +
                    " (" + msg.name + ")")
                    .css("color", "red")
                );
            });
            socket.on("player processed", function(msg) {
                $("#updates").append(
                    $("<li>")
                    .text("processed player " + msg)
                    .css("color", "green")
                );
            });
            socket.on("player compiled", function(msg) {
                $("#updates").append(
                    $("<li>")
                    .text("compiled player " + msg)
                    .css("color", "orange")
                );
            });
        </script>
    </body>
</html>
